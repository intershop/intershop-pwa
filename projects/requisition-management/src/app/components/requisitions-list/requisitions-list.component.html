<ng-container *ngIf="requisitions?.length > 0; else emptyList">
  <table
    cdk-table
    [dataSource]="requisitions"
    class="table table-lg mobile-optimized"
    data-testing-id="requisition-list"
  >
    <!-- Requisition No -->
    <ng-container cdkColumnDef="requisitionNo">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-requisition-no">
        {{ 'account.approvallist.table.id_of_order' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.id_of_order' | translate">
        <!-- TODO: routing must work for standalone usage, needs to be more relative without the 'account' part -->
        <a [routerLink]="[requisition.id, { requisitionStatus: requisitionStatus }]">{{ requisition.requisitionNo }}</a>
      </td>
    </ng-container>

    <!-- Order No -->
    <ng-container cdkColumnDef="orderNo">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-order-no">
        {{ 'account.approvallist.table.no_of_order' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.no_of_order' | translate">
        <a [routerLink]="['../../orders/', requisition.id]">{{ requisition.orderNo }}</a>
      </td>
    </ng-container>

    <!-- Creation Date -->
    <ng-container cdkColumnDef="creationDate">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-creation-date">
        {{ 'account.approvallist.table.date_of_order' | translate }}
      </th>
      <td
        cdk-cell
        *cdkCellDef="let requisition"
        [attr.data-th]="'account.approvallist.table.date_of_order' | translate"
      >
        {{ requisition.creationDate | ishDate }}
      </td>
    </ng-container>

    <!-- Approver -->
    <ng-container cdkColumnDef="approver">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-approver">
        {{ 'account.approvallist.table.approver' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.approver' | translate">
        {{ requisition.approval?.approver?.firstName }} {{ requisition.approval?.approver?.lastName }}
      </td>
    </ng-container>

    <!-- Buyer -->
    <ng-container cdkColumnDef="buyer">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-buyer">
        {{ 'account.approvallist.table.purchaser' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.purchaser' | translate">
        {{ requisition.user.firstName }} {{ requisition.user.lastName }}
      </td>
    </ng-container>

    <!-- Approval Date -->
    <ng-container cdkColumnDef="approvalDate">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-approval-date">
        {{ 'account.approvallist.table.approval_date' | translate }}
      </th>
      <td
        cdk-cell
        *cdkCellDef="let requisition"
        [attr.data-th]="'account.approvallist.table.approval_date' | translate"
      >
        {{ requisition.approval.approvalDate | ishDate }}
      </td>
    </ng-container>

    <!-- Rejection Date -->
    <ng-container cdkColumnDef="rejectionDate">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-rejection-date">
        {{ 'account.approvallist.table.reject_date' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.reject_date' | translate">
        {{ requisition.approval.approvalDate | ishDate }}
      </td>
    </ng-container>

    <!-- Items count -->
    <ng-container cdkColumnDef="lineItems">
      <th cdk-header-cell *cdkHeaderCellDef data-testing-id="th-line-items">
        {{ 'account.approvallist.table.line_items' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" [attr.data-th]="'account.approvallist.table.line_items' | translate">
        {{ requisition.lineItemCount }}
      </td>
    </ng-container>

    <!-- Total -->
    <ng-container cdkColumnDef="orderTotal">
      <th cdk-header-cell *cdkHeaderCellDef class="text-right" data-testing-id="th-order-total">
        {{ 'account.approvallist.table.line_item_total' | translate }}
      </th>
      <td cdk-cell *cdkCellDef="let requisition" class="text-right">
        {{ requisition.totals.total | ishPrice: 'gross' }}
      </td>
    </ng-container>

    <!-- Header and Row Declarations -->
    <tr cdk-header-row *cdkHeaderRowDef="columnsToDisplay"></tr>
    <tr cdk-row *cdkRowDef="let row; columns: columnsToDisplay"></tr>
  </table>

  <div data-testing-id="list-counter">
    {{ requisitions?.length | i18nPlural: ('account.approvallist.items' | translate) || { other: '#' } }}
  </div>
</ng-container>

<ng-template #emptyList>
  <p data-testing-id="emptyList">{{ 'account.approvallist.no_items_message' | translate }}</p>
</ng-template>
